{% extends 'base.html.twig' %}

{% block title %}Mettre un nouvel article en vente{% endblock %}

{% block body %}
<div class="form-container">
    <h1 class="site-title">Mettre un nouvel article en vente</h1>

    {{ form_start(form) }}
        <div class="form-columns">
            <div class="form-column-left">
                <fieldset>
                    <legend>D√©tails de l'article</legend>
                    
                    <div class="form-group">
                        {{ form_label(form.title, null, {'attr': {'class': 'form-label form-required'}}) }}
                        {{ form_widget(form.title, {'attr': {'class': 'form-control', 'placeholder': 'Ex: Dracaufeu Holographique'}}) }}
                        {{ form_errors(form.title) }}
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            {{ form_label(form.number, null, {'attr': {'class': 'form-label'}}) }}
                            {{ form_widget(form.number, {'attr': {'class': 'form-control', 'placeholder': 'Ex: 4/102'}}) }}
                            {{ form_errors(form.number) }}
                        </div>

                        <div class="form-group">
                            {{ form_label(form.category, null, {'attr': {'class': 'form-label'}}) }}
                            {{ form_widget(form.category, {'attr': {'class': 'form-control', 'placeholder': 'Ex: Carte Pok√©mon'}}) }}
                            {{ form_errors(form.category) }}
                        </div>
                    </div>

                    <div class="form-group">
                        {{ form_label(form.price, null, {'attr': {'class': 'form-label form-required'}}) }}
                        {{ form_widget(form.price, {'attr': {'class': 'form-control', 'min': '0', 'step': '0.01', 'placeholder': '0.00'}}) }}
                        {{ form_errors(form.price) }}
                        <div class="form-help">Prix en euros (‚Ç¨)</div>
                    </div>
                </fieldset>
            </div>

            <div class="form-column-right">
                <fieldset>
                    <legend>Description & M√©dias</legend>
                    
                    <div class="form-group">
                        {{ form_label(form.description, null, {'attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.description, {'attr': {'class': 'form-control', 'rows': '5', 'placeholder': 'D√©crivez votre article en d√©tail...'}}) }}
                        {{ form_errors(form.description) }}
                        <div class="form-help">Une bonne description augmente vos chances de vente</div>
                    </div>

                    <div class="form-group">
                        {{ form_label(form.imageFiles, 'Photos de votre article', {'attr': {'class': 'form-label'}}) }}
                        <div class="form-image-upload">
                            <div class="form-file-input">
                                {{ form_widget(form.imageFiles, {'attr': {'accept': 'image/*', 'multiple': true}}) }}
                                <label for="{{ form.imageFiles.vars.id }}" class="form-file-label">
                                    üì∑ Choisir des photos (PNG, JPG)
                                </label>
                            </div>
                            <button type="button" id="webcam-button" class="btn btn--secondary" aria-label="Utiliser la webcam pour prendre une photo">
                                üì± Webcam
                            </button>
                        </div>
                        {{ form_errors(form.imageFiles) }}
                        <div class="form-help">Formats accept√©s : PNG, JPG - Taille max : 5MB par fichier</div>
                        <div id="image-preview-container"></div>
                    </div>
                </fieldset>
            </div>
        </div>

        <div class="form-actions">
            <a href="{{ path('app_user_products') }}" class="btn btn--secondary">Annuler</a>
            <button type="submit" class="btn btn--primary">üöÄ Mettre en vente</button>
        </div>
    {{ form_end(form) }}
</div>

{# Modale pour la webcam #}
<div id="webcam-modal" class="webcam-modal" style="display: none;" aria-hidden="true" role="dialog">
    <div class="webcam-modal-content">
        <h3>Prendre une photo avec la webcam</h3>
        <video id="webcam-video" autoplay playsinline aria-label="Aper√ßu de la webcam"></video>
        <canvas id="webcam-canvas" style="display: none;"></canvas>
        <div class="webcam-controls">
            <button type="button" id="capture-button" class="btn btn--primary" aria-label="Capturer la photo">üì∏ Prendre la photo</button>
            <button type="button" id="close-webcam-button" class="btn btn--secondary" aria-label="Fermer la webcam">‚ùå Fermer</button>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/product-form.js') }}" defer></script>
{% endblock %} 